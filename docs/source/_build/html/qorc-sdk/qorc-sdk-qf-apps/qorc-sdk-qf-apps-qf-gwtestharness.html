

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>QuickFeather Gateware Test Harness Application &mdash; QORC-SDK  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="&lt;no title&gt;" href="qorc-sdk-qf-apps-qf-bootloader.html" />
    <link rel="prev" title="QuickFeather FPGA UART Application" href="qorc-sdk-qf-apps-qf-fpgauart-app.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/qorc_whitebg.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../qorc-setup/qorc-setup.html">Setup</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../qorc-sdk.html">QORC-SDK</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../qorc-sdk-hal/qorc-sdk-hal.html">QORC-SDK HAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../qorc-sdk-libraries/qorc-sdk-libraries.html">QORC-SDK Libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../qorc-sdk-s3-gateware/qorc-sdk-s3-gateware.html">QORC-SDK EOS S3 FPGA Designs</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="qorc-sdk-qf-apps.html">QuickFeather Applications</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="qorc-sdk-qf-apps-qf-helloworldsw.html">QuickFeather Hello World (Cortex M4) Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="qorc-sdk-qf-apps-qf-helloworldhw.html">QuickFeather Hello World (Cortex M4 + FPGA) Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="qorc-sdk-qf-apps-qf-fpgauart-app.html">QuickFeather FPGA UART Application</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">QuickFeather Gateware Test Harness Application</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#purpose">Purpose</a></li>
<li class="toctree-l4"><a class="reference internal" href="#setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#running-qf-gwtestharness">Running qf_gwtestharness</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="qorc-sdk-qf-apps-qf-bootloader-uart.html">QuickFeather Bootloader Application (UART)</a></li>
<li class="toctree-l3"><a class="reference internal" href="qorc-sdk-qf-apps-qf-loadflash.html">QuickFeather Flash Loader Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="qorc-sdk-qf-apps-qf-loadflash-uart.html">QuickFeather Flash Loader Application (UART)</a></li>
<li class="toctree-l3"><a class="reference internal" href="qorc-sdk-qf-apps-qf-mqttsn-ai-app.html">Quickfeather AI Application Project</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../qorc-sdk-qf-vr-apps/qorc-sdk-qf-vr-apps.html">QORC Voice Recognition apps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../qorc-sdk-qorc-test-apps/qorc-sdk-qorc-test-apps.html">QORC Test Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../qorc-example-apps/qorc-example-apps.html">QORC Example Applications</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../ql-symbiflow/ql-symbiflow.html">QuickLogic FPGA Toolchain</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ql-development-boards/ql-development-boards.html">QuickLogic Development Boards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ql-eos-s3/ql-eos-s3.html">QuickLogic EOS S3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ql-faq/ql-faq.html">FAQ</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">QORC-SDK</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../qorc-sdk.html">QORC-SDK</a> &raquo;</li>
        
          <li><a href="qorc-sdk-qf-apps.html">QuickFeather Applications</a> &raquo;</li>
        
      <li>QuickFeather Gateware Test Harness Application</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/qorc-sdk/qorc-sdk-qf-apps/qorc-sdk-qf-apps-qf-gwtestharness.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="quickfeather-gateware-test-harness-application">
<h1>QuickFeather Gateware Test Harness Application<a class="headerlink" href="#quickfeather-gateware-test-harness-application" title="Permalink to this headline">¶</a></h1>
<div class="section" id="purpose">
<h2>Purpose<a class="headerlink" href="#purpose" title="Permalink to this headline">¶</a></h2>
<p>The purpose of this app is to provide a software framework that allows
gateware developrs to perform basic function tests on their gateware
before releaseing the gateware to teh software developers. The harness
loads the gatware, starts the FPGA clocks, and runs a CLI (Command Line
Interface) that allows the developer to:</p>
<ul class="simple">
<li><p>read the ID register (register 0x00)</p></li>
<li><p>read any arbitrary register</p></li>
<li><p>write any arbitrary register</p></li>
</ul>
<p>The thought process is that reading the ID register provides a basic
proof of life, and from there the developer can read and write registers
to monitor and exercise the gateware (slowly, of course).</p>
</div>
<div class="section" id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h2>
<div class="section" id="setup-gateware">
<h3>Setup gateware<a class="headerlink" href="#setup-gateware" title="Permalink to this headline">¶</a></h3>
<p>The app is located in qorc-sdk/qf_apps/qf_gwtestharness. This example
application uses the UART+GPIO design located in
projects/S3_FPGA_UART_GPIO folder of the s3-gateware submodule. The new
gateware should be replace the example gateware located on the gateware
directory. Gateware is split between the projects directory, which
contains the top level designs, and the modules directory, which
contains common modules. The example used by this application uses the
modules UART_16550 and GPIO located in ip_modules folder of s3-gateware
submodule. Note that all designs will have a project, but not all
designs will use modules.</p>
<div class="line-block">
<div class="line">You will want to add a new directory under projects for you project:
projects/yourproject.</div>
<div class="line">And if you project uses modules, add the appropriate module
directories under the modules directory.</div>
</div>
<p>You will need a makefile in the projects directory that creates
top_bit.h in the projects directory. Recommend that you simply copy the
makefile from projects/S3_FPGA_UART_GPIO into your project directory (it
should not require modification), and copy the makefile from
projects/S3_FPGA_UART_GPIO/rtl into you rtl directory. The makefile in
the RTL directory shold be modified to specify any modules that are
used. This is done by replacing ‘UART_16550’ with the list of used
modules (or blank if no moduels are used) in the line ‘IPMODULES =
UART_16550’.</p>
<p>At this point you can test the gateware build by cd gateware/yourproject
and make all. This should create top_bit.h in gateware/yourproject.</p>
</div>
<div class="section" id="setup-software">
<h3>Setup software<a class="headerlink" href="#setup-software" title="Permalink to this headline">¶</a></h3>
<p>You will need to edit the config-GCC.mk file which is located in the
qf_apps/qf_gwtestharness/GCC_Project directory. On the line that says</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>export GATEWARE_DIR=$(PROJ_ROOT)/s3-gateware/projects/S3_FPGA_UART_GPIO
</pre></div>
</div>
<p>replace the S3_FPGA_UART_GPIO with the name of the directory that
contains your project.</p>
<p>Running make from the GCC_Project directory should now create a
qf_gwtestharness app that includes your project.</p>
<p>The default clocks is 12MHz for both FPGA clocks. If this is not
appropriate, you will need to edit main.c and set the clock values that
you want.</p>
<p>Update the qf_apps/qf_gwtestharness/src/pincfg_table.c to setup S3 pin
configuration as defined in the quickfeather.pcf file in your
projects/yourproject directory</p>
</div>
</div>
<div class="section" id="running-qf-gwtestharness">
<h2>Running qf_gwtestharness<a class="headerlink" href="#running-qf-gwtestharness" title="Permalink to this headline">¶</a></h2>
<p>qf_gwtestharness sends its output to the UART pins on teh Quickfeeather
board, so you will need to attach a USB to serial adaptor to the
appropriate pins, and then use a terminal emualtor, set to 115200 baud,
to interact with the application.</p>
<p>qf_gwtestharness will send various banner messages to the terminal and
eventually end up at the starting CLI prompt:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##########################</span>
<span class="n">Quicklogic</span> <span class="n">QuickFeather</span> <span class="n">Bootloader</span>
<span class="n">SW</span> <span class="n">Version</span><span class="p">:</span> <span class="n">qorc</span><span class="o">-</span><span class="n">sdk</span><span class="o">/</span><span class="n">qf</span><span class="o">-</span><span class="n">apps</span><span class="o">/</span><span class="n">qf_bootloader</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span> <span class="p">(</span><span class="n">GCC</span><span class="p">)</span>
<span class="n">Jun</span>  <span class="mi">7</span> <span class="mi">2020</span> <span class="mi">11</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mi">58</span>
<span class="c1">##########################</span>

<span class="n">User</span> <span class="n">button</span> <span class="ow">not</span> <span class="n">pressed</span><span class="p">:</span> <span class="n">proceeding</span> <span class="n">to</span> <span class="n">load</span> <span class="n">application</span>


<span class="c1">##########################</span>
<span class="n">Quicklogic</span> <span class="n">QuickFeather</span> <span class="n">Gateware</span> <span class="n">Test</span> <span class="n">Harness</span>
<span class="n">SW</span> <span class="n">Version</span><span class="p">:</span> <span class="n">qorc</span><span class="o">-</span><span class="n">sdk</span><span class="o">/</span><span class="n">qf_apps</span><span class="o">/</span><span class="n">qf_gwtestharness</span>
<span class="n">Sep</span> <span class="mi">20</span> <span class="mi">2020</span> <span class="mi">14</span><span class="p">:</span><span class="mi">24</span><span class="p">:</span><span class="mi">43</span>
<span class="c1">##########################</span>

<span class="c1">#*******************</span>
<span class="n">Command</span> <span class="n">Line</span> <span class="n">Interface</span>
<span class="n">App</span> <span class="n">SW</span> <span class="n">Version</span><span class="p">:</span> <span class="n">qorc</span><span class="o">-</span><span class="n">sdk</span><span class="o">/</span><span class="n">qf_apps</span><span class="o">/</span><span class="n">qf_gwtestharness</span>
<span class="c1">#*******************</span>
<span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span>
</pre></div>
</div>
<p>If you type ‘help’ you will get a list of options:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[0] &gt; help
help-path: (top)
gwtest         - General test harness for gateware
diag           - QuickFeather diagnostic commands
exit           - exit/leave menu
help           - show help
?              - show help
help-end:
[0] &gt;
</pre></div>
</div>
<p>The easiest way to interact with your gateware is to switch to the
gateware test menu by typing ‘gwtest’:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[0] &gt; gwtest
[1] gwtest &gt; help
help-path: gwtest
readid         - -- read the gateware id reister (@0x00)
readreg        -  0xaddr -- read register at specified address
writereg       - 0xaddr 0xvalue -- write val to specified address
exit           - exit/leave menu
help           - show help
?              - show help
help-end:
[1] gwtest &gt;
</pre></div>
</div>
<p>The ‘[1] gwtest &gt;’ indicates that you are in the first level submenu
called ‘gwtest’. The ‘help’ shows that there are three commands that you
can issue:</p>
<ul class="simple">
<li><p><em>readid</em> which will read register at address 0x00 (normally the ID
register)</p></li>
<li><p><em>readreg 0xaddr</em> which will read the register at address</p></li>
<li><p><em>writereg 0xvalue 0xaddr</em> which will set the register at addr to
value</p></li>
</ul>
<p>Note that readreg and writereg assume that the register is uint32, and
that the addresses are byte offsets.</p>
<p>Example of <em>readid</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">gwtest</span> <span class="o">&gt;</span> <span class="n">readid</span>
<span class="nb">id</span> <span class="n">register</span> <span class="o">=</span><span class="p">:</span> <span class="mh">0xabcd0001</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">gwtest</span> <span class="o">&gt;</span>
</pre></div>
</div>
<p>Example of <em>readreg</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">gwtest</span> <span class="o">&gt;</span> <span class="n">readreg</span> <span class="mh">0x04</span>
<span class="n">address</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">register</span> <span class="n">at</span><span class="p">:</span> <span class="mh">0x00000004</span>
<span class="n">value</span>      <span class="p">:</span> <span class="mh">0x00000100</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">gwtest</span> <span class="o">&gt;</span>
</pre></div>
</div>
<p>Example of <em>writereg</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">gwtest</span> <span class="o">&gt;</span> <span class="n">writereg</span> <span class="mh">0xbeef</span> <span class="mh">0x10</span>
<span class="n">address</span> <span class="o">=</span> <span class="mi">48879</span>
<span class="n">value</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">uxValue</span><span class="p">:</span> <span class="mh">0x00000010</span>
<span class="n">register</span> <span class="n">at</span>    <span class="p">:</span> <span class="mh">0x0000beef</span>
<span class="n">register</span> <span class="nb">set</span> <span class="n">to</span><span class="p">:</span> <span class="mh">0x00000010</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">gwtest</span> <span class="o">&gt;</span>
</pre></div>
</div>
<p>Of course this just wrote 0xbeef to the register, whether the register
changed depends on whether the register is writable.</p>
<div class="toctree-wrapper compound">
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="qorc-sdk-qf-apps-qf-bootloader.html" class="btn btn-neutral float-right" title="&lt;no title&gt;" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="qorc-sdk-qf-apps-qf-fpgauart-app.html" class="btn btn-neutral float-left" title="QuickFeather FPGA UART Application" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, QuickLogic Corp

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>